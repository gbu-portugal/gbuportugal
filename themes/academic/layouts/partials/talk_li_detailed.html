<div class="card-simple" itemscope itemtype="http://schema.org/Event">

  {{ if .Params.image_preview }}
    {{ .Scratch.Set "image" .Params.image_preview }}
  {{ else if .Params.header.image }}
    {{ .Scratch.Set "image" .Params.header.image }}
  {{ end }}
  {{ if .Scratch.Get "image" }}
  <div>
    <a href="{{ .Permalink }}">
      {{ $img_src := urls.Parse (.Scratch.Get "image") }}
      {{ if $img_src.Scheme }}
        <img src="{{ .Scratch.Get "image" }}" class="article-banner" itemprop="image">
      {{ else }}
        <img src="{{ "/img/" | relURL }}{{ .Scratch.Get "image" }}" class="article-banner" itemprop="image">
      {{ end }}
    </a>
  </div>
  {{ end }}

  <h3 class="article-title" itemprop="name">
    <a href="{{ .Permalink }}" itemprop="url">{{ .Title }}</a>
  </h3>

  <div class="talk-metadata" itemprop="startDate">
  {{ if not .Params.time_end }}
    {{ (time .Params.time_start).Format $.Site.Params.date_format }}
  {{ else }}
    {{ if ((time .Params.time_start).AddDate 0 0 1).After (time .Params.time_end) }}
      {{ (time .Params.time_start).Format $.Site.Params.date_format }}
      {{ (time .Params.time_start).Format ($.Site.Params.time_format | default "3:04 PM") }}
      &mdash;
      {{ (time .Params.time_end).Format ($.Site.Params.time_format | default "3:04 PM") }}
    {{ else }}
      {{ (time .Params.time_start).Format $.Site.Params.date_format }}
      &mdash;
      {{ (time .Params.time_end).Format $.Site.Params.date_format }}
    {{ end }}
  {{ end }}
  </div>

  <div class="talk-metadata">
    {{ if .Params.event }}
    {{ .Params.event | markdownify }}
    {{ else if .Params.event_short }}
    {{ .Params.event_short | markdownify }}
    {{ end }}
  </div>

  {{ if .Params.abstract }}
  <div class="talk-abstract" itemprop="text">
    {{ if .Params.abstract_short }}
    {{ .Params.abstract_short | markdownify }}
    {{ else }}
    {{ .Params.abstract | markdownify }}
    {{ end }}
  </div>
  {{ end }}

  <div class="talk-links">
    {{ partial "talk_links" (dict "content" . "is_list" 1) }}
  </div>

</div>
